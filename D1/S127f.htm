<HTML><HEAD><TITLE>Naming and Storing Property Sets</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Naming and Storing Property Sets</H3><P>The purpose of having a property set is to facilitate data exchange between components and applications. I shouldn't need to say too much to convince you that a property set isn't necessarily the most efficient way to store your own internal data. You need to use a property set primarily when you want to share persistent information.</P>
<P>A property set is always considered an attachment to a compound file. It is contained either as a single stream in that file or as a substorage in that file if the property set spans multiple streams in that substorage. The reason is simple:  any other code can navigate through your compound file and locate property sets. In Chapter 7, we saw that OLE reserves any storage or stream element name from ASCII 5 through ASCII 31 for its own use. Naming a property set is one use for a reserved prefix. Specifically, the  ASCII 5 prefix (usually written as \005) identifies a common property set in a storage or stream. <I>Common</I> means that the property set is known to many applications and to the system. The Summary Information stream is an example of this.</P>
<P>When property sets are stored in a substorage, the primary stream of the set should be named "CONTENTS" and the CLSID of the storage should be identical to the CLSID written into the property set. Only when the property set takes up an entire substorage are properties of type VT_STREAM, VT_STORAGE, VT_STREAMED_OBJECT, VT_STORED_OBJECT, and VT_BLOB_OBJECT legal. Specific substorages or streams containing those other properties are siblings of the "CONTENTS" stream itself.</P></font></body></HTML>
