<HTML><HEAD><TITLE>Default Handler IOleObject Behavior</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Default Handler <I>IOleObject</I> Behavior</H3><P>Only two member functions in <I>IOleObject</I> always attempt to run the local server and delegate the call: <I>DoVerb</I> and <I>Update</I>. All others either have minimal implementations or simply return an HRESULT, as shown in Table 19-1. Also, the default handler saves the information from <I>Advise</I>, <I>Unadvise</I>, <I>EnumAdvise</I>, <I>SetClientSite</I>, <I>G</I><I>etClientSite</I>, and <I>SetHostNames</I> so that if and when it launches a local server, it can forward that information. When the server is running, all of these functions are delegated to the running object.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="221pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Member Function</B></P></TD><TD VALIGN="TOP"><P><B>Action</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Advise</P></TD><TD VALIGN="TOP"><P>Calls <I>CreateOleAdviseHolder</I> if an advise holder has not yet been created. In either case, delegates to <I>IOleAdviseHolder::Advise</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Close</P></TD><TD VALIGN="TOP"><P>Meaningless without a running server, so it returns NOERROR.</P></TD></TR><TR><TD VALIGN="TOP"><P>DoVerb*</P></TD><TD VALIGN="TOP"><P>Runs and delegates to the server.</P></TD></TR><TR><TD VALIGN="TOP"><P>EnumAdvise</P></TD><TD VALIGN="TOP"><P>Delegates to <I>IO</I><I>leAdviseHolder</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>EnumVerbs</P></TD><TD VALIGN="TOP"><P>Delegates to <I>OleRegEnumVerbs</I> and returns.</P></TD></TR><TR><TD VALIGN="TOP"><P>GetClientSite</P></TD><TD VALIGN="TOP"><P>Returns the last <I>IOleClientSite</I> seen in <I>SetClientSite</I> and NOERROR.</P></TD></TR><TR><TD VALIGN="TOP"><P>GetClipboardData</P></TD><TD VALIGN="TOP"><P>Returns OLE_E_NOTRUNNING.</P></TD></TR><TR><TD VALIGN="TOP"><P>GetExtent</P></TD><TD VALIGN="TOP"><P>Attempts to locate the requested aspect in the cache and returns the size of that presentation if available.</P></TD></TR><TR><TD VALIGN="TOP"><P>GetMiscStatus</P></TD><TD VALIGN="TOP"><P>Delegates to <I>OleRegGetMiscStatus</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>GetMoniker</P></TD><TD VALIGN="TOP"><P>Calls <I>IOleClientSite::GetMoniker</I> if <I>SetClientSite</I> has been called with a valid <I>IOleClientSite</I> pointer. Otherwise, returns E_UNSPEC.</P></TD></TR><TR><TD VALIGN="TOP"><P>GetUserClassID</P></TD><TD VALIGN="TOP"><P>Returns the CLSID passed to <I>OleCreateDefaultHandler</I>, mapped to a new CLSID if emulation is active, and NOERROR.</P></TD></TR><TR><TD VALIGN="TOP"><P>GetUserType</P></TD><TD VALIGN="TOP"><P>Delegates to <I>OleRegGetUserType</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>InitFromData</P></TD><TD VALIGN="TOP"><P>Returns OLE_E_NOTRUNNING.</P></TD></TR><TR><TD VALIGN="TOP"><P>IsUpToDate</P></TD><TD VALIGN="TOP"><P>Returns OLE_E_NOTRUNNING.</P></TD></TR><TR><TD VALIGN="TOP"><P>SetClientSite</P></TD><TD VALIGN="TOP"><P>Saves the <I>IOleClientSite</I> pointer in an internal variable and returns NOERROR.</P></TD></TR><TR><TD VALIGN="TOP"><P>SetColorScheme</P></TD><TD VALIGN="TOP"><P>Returns OLE_E_NOTRUNNING.</P></TD></TR><TR><TD VALIGN="TOP"><P>SetExtent</P></TD><TD VALIGN="TOP"><P>Returns OLE_E_NOTRUNNING.</P></TD></TR><TR><TD VALIGN="TOP"><P>SetHostNames</P></TD><TD VALIGN="TOP"><P>Stores the strings in atoms and returns NOERROR.</P></TD></TR><TR><TD VALIGN="TOP"><P>SetMoniker</P></TD><TD VALIGN="TOP"><P>Returns NOERROR.</P></TD></TR><TR><TD VALIGN="TOP"><P>Unadvise</P></TD><TD VALIGN="TOP"><P>Delegates to <I>IOleAdviseHolder</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Update*</P></TD><TD VALIGN="TOP"><P>Runs the server and delegates to it.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>Table 19-1</B></P>
<P><B>Behavior of the default handler's <I>IOleObject</I> interface for a non-running object.</B></P>
<P>*  Launches the local server</P></font></body></HTML>
