<HTML><HEAD><TITLE>What Does It Mean, "Canonical"?</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>What Does It Mean, "Canonical"?</H3><P>The word "canonical" means "the simplest form of something," which is the basic idea behind <I>GetCanonicalFormatEtc</I>. This function allows a consumer to obtain a FORMATETC structure that describes exactly the same rendering of a difficult FORMATETC. In general, the canonical FORMATETC should contain the most general information possible for a specific rendering. For example, a data source that always provides the same metafile for any device, for either DVASPECT_CONTENT or DVASPECT_THUMBNAIL aspects, would return from this function a structure with <I>cfFormat </I>set to CF_METAFILEPICT, <I>dwAspect </I>set to content and thumbnail, <I>p</I><I>td </I>set to NULL (device independent), and <I>lindex </I>set to <FONT FACE="Symbol">-</FONT>1 (<I>tymed </I>is irrelevant). All other FORMATETC descriptions with a specific target device are more specific instances of this basic, canonical FORMATETC.</P>
<P>The simplest implementation of <I>GetCanonicalFormatEtc </I>copies the input structure to the output structure, sets the output <I>ptd </I>field to NULL, and returns DATA_S_SAMEFORMATETC. This says that the data object doesn't care about target devices for the specific FORMATETC. If, on the other hand, the source does care, it returns NOERROR, filling the output FORMATETC as generally as it can.</P>
<P>The entire reason for <I>GetCanonicalFormatEtc </I>is to give a consumer a way to compare whether two calls to <I>GetData </I>with two different FORMATETC structures will produce exactly the same rendering. If so, the consumer can bypass the second <I>GetData </I>call and use the data obtained from the first. This cuts down on memory wasted for duplicate renderings and improves overall performance.</P></font></body></HTML>
