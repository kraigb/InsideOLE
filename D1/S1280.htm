<HTML><HEAD><TITLE>The Summary Information Property Set</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>The Summary Information Property Set</H3><P>At the time of writing, Microsoft has defined only a single standard property set, Summary Information. This property set is defined as a stream named "\005SummaryInformation" (saving it as a storage is not allowed), and its FMTID is <I>F29F85E0-4FF9-1068-AB91-08002B</I><I>27B3D9</I>. As we described earlier, a specific property set defines the meaning of each property within it and assigns the PIDs. Those for Summary Information are listed in Table 16-2.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="110pt" VALIGN="TOP"><COL WIDTH="110pt" VALIGN="TOP"><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="98pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Property Name</B></P></TD><TD VALIGN="TOP"><P><B>Property ID</B></P></TD><TD VALIGN="TOP"><P><B>PID</B></P></TD><TD VALIGN="TOP"><P><B>Type</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Title</P></TD><TD VALIGN="TOP"><P>PID_TITLE</P></TD><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Subject</P></TD><TD VALIGN="TOP"><P>PID_SUBJECT</P></TD><TD VALIGN="TOP"><P>3</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Author</P></TD><TD VALIGN="TOP"><P>PID_AUTHOR</P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Keywords</P></TD><TD VALIGN="TOP"><P>PID_KEYWORDS</P></TD><TD VALIGN="TOP"><P>5</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Comments</P></TD><TD VALIGN="TOP"><P>PID_COMMENTS</P></TD><TD VALIGN="TOP"><P>6</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Template</P></TD><TD VALIGN="TOP"><P>PID_TEMPLATE</P></TD><TD VALIGN="TOP"><P>7</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Last Saved By</P></TD><TD VALIGN="TOP"><P>PID_LASTAUTHOR</P></TD><TD VALIGN="TOP"><P>8</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Revision Number</P></TD><TD VALIGN="TOP"><P>PID_REVNUMBER</P></TD><TD VALIGN="TOP"><P>9</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Total Editing Time</P></TD><TD VALIGN="TOP"><P>PID_EDITTIME</P></TD><TD VALIGN="TOP"><P>10</P></TD><TD VALIGN="TOP"><P>VT_FILETIME</P></TD></TR><TR><TD VALIGN="TOP"><P>Last Printed</P></TD><TD VALIGN="TOP"><P>PID_LASTPRINTED</P></TD><TD VALIGN="TOP"><P>11</P></TD><TD VALIGN="TOP"><P>VT_FILETIME</P></TD></TR><TR><TD VALIGN="TOP"><P>Create Time/Date</P></TD><TD VALIGN="TOP"><P>PID_CREATE_DTM</P></TD><TD VALIGN="TOP"><P>12</P></TD><TD VALIGN="TOP"><P>VT_FILETIME</P></TD></TR><TR><TD VALIGN="TOP"><P>Last Saved Time/Date</P></TD><TD VALIGN="TOP"><P>PID_LASTSAVE_DTM</P></TD><TD VALIGN="TOP"><P>13</P></TD><TD VALIGN="TOP"><P>VT_FILETIME</P></TD></TR><TR><TD VALIGN="TOP"><P>Number of Pages</P></TD><TD VALIGN="TOP"><P>PID_PAGECOUNT</P></TD><TD VALIGN="TOP"><P>14</P></TD><TD VALIGN="TOP"><P>VT_I4</P></TD></TR><TR><TD VALIGN="TOP"><P>Number of Words</P></TD><TD VALIGN="TOP"><P>PID_WORDCOUNT</P></TD><TD VALIGN="TOP"><P>15</P></TD><TD VALIGN="TOP"><P>VT_I4</P></TD></TR><TR><TD VALIGN="TOP"><P>Number of Characters</P></TD><TD VALIGN="TOP"><P>PID_CHARCOUNT</P></TD><TD VALIGN="TOP"><P>16</P></TD><TD VALIGN="TOP"><P>VT_I4</P></TD></TR><TR><TD VALIGN="TOP"><P>Thumbnail</P></TD><TD VALIGN="TOP"><P>PID_THUMBNAIL</P></TD><TD VALIGN="TOP"><P>17</P></TD><TD VALIGN="TOP"><P>VT_CF</P></TD></TR><TR><TD VALIGN="TOP"><P>Name of Creating Application</P></TD><TD VALIGN="TOP"><P>PID_APPNAME</P></TD><TD VALIGN="TOP"><P>18</P></TD><TD VALIGN="TOP"><P>VT_LPSTR</P></TD></TR><TR><TD VALIGN="TOP"><P>Security</P></TD><TD VALIGN="TOP"><P>PID_SECURITY</P></TD><TD VALIGN="TOP"><P>19</P></TD><TD VALIGN="TOP"><P>VT_I4</P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>Table 16-2.</B></P>
<P><B>The Summary Information property set.</B></P>
<P>PID_CREATE_DTM is considered a read-only value once it is present in a property set. In other words, the creation date of whatever file this property set is attached to is determined only once. No one has the need to change the value later. Also, PID_THUMBNAIL should contain a metafile or bitmap (device-dependent or device-independent); a metafile is recommended. A final note is that PID_SECURITY is a set of suggested access-control flags, shown in the following table. The code that reads the property set and the document should honor these flags:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="135pt" VALIGN="TOP"><COL WIDTH="221pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Security Level</B></P></TD><TD VALIGN="TOP"><P><B>Value</B></P></TD></TR><TR><TD VALIGN="TOP"><P>None</P></TD><TD VALIGN="TOP"><P>0</P></TD></TR><TR><TD VALIGN="TOP"><P>Password protected</P></TD><TD VALIGN="TOP"><P>1</P></TD></TR><TR><TD VALIGN="TOP"><P>Read-only recommended</P></TD><TD VALIGN="TOP"><P>2</P></TD></TR><TR><TD VALIGN="TOP"><P>Read-only enforced</P></TD><TD VALIGN="TOP"><P>4</P></TD></TR><TR><TD VALIGN="TOP"><P>Locked for annotations</P></TD><TD VALIGN="TOP"><P>8</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>The way an application obtains much of the information that it writes into this property set is up to that application. Various applications in Microsoft Office have a Summary Info command on the File menu; choosing this command displays a dialog box in which the user can enter most of the string-related information. Information such as word count and a thumbnail sketch can be obtained without the user's direct input.</P>
<P>Regardless of how an application obtains the information, Microsoft is strongly encouraging developers of applications that write information into compound files to include the Summary Information property set as a stream underneath the file's root storage. And for good reasons. Historically, the properties contained in Summary Information have always been wrapped inside an application's proprietary file format. If a user wanted to view or otherwise use that information, he or she had to run the application that created it. Besides simply looking at the information, users often search for files on the basis of a set of criteria, such as "search for all documents written by Terry White after 6/17/94 that contain the phrases 'west region' or 'central region' in either the title, subject, or keywords."  When summary information data is locked in a proprietary file format, users have to search through each application's file type individually, a tedious process at best.</P>
<P>To facilitate systemwide document searches, Microsoft has used OLE's Property Sets and Compound Files to specify a standard structure for this information (the property set) and a standard place to store it (the compound file). Any application can retrieve these properties and use them for display or searching purposes. The Windows 95 Explorer, for example, allows you to view the summary information attached to any compound file without running the application that created that file. Future versions of Windows will use this information to perform file searches. In such a system, the shell allows the user to specify criteria that are then matched against summary information to generate a list of matching files. All of this happens quickly because there is no need to load more than a small block of data from any file.</P></font></body></HTML>
