<HTML><HEAD><TITLE>Binding a Moniker</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Binding a Moniker</H3><P>From the client's perspective, binding couldn't be much easier: call the API function <I>BindMoniker</I> or call <I>IMoniker::BindToObject </I>if you want more control over the bind context. LinkUser centralizes this process in <I>CApp::BindAndShow </I>(LINKUSER.CPP), which binds the moniker to obtain an <I>IDescription </I>interface for the object and then asks that object to render its text description with <I>IDescription::GetText</I>:</P>
<P><BR></P>
<pre><code>void CApp::BindAndShow(IMoniker *pmk, IBindCtx *pbc)<BR>    {<BR>    HRESULT         hr;<BR>    IDescription   *pIDescription;<BR><BR>    if (NULL==pbc)<BR>        {<BR>        hr=BindMoniker(pmk, 0, IID_IDescription<BR>            , (void **)&amp;pIDescription);<BR>        }<BR>    else<BR>        {<BR>        hr=pmk-&gt;BindToObject(pbc, NULL, IID_IDescription<BR>            , (void **)&amp;pIDescription);<BR>        }<BR><BR>    if (SUCCEEDED(hr))<BR>        {<BR>        const long  cch=512;<BR>        TCHAR       szText[cch];<BR><BR>        hr=pIDescription-&gt;GetText(szText, cch);<BR>        pIDescription-&gt;Release();<BR><BR>        [Show appropriate message on success or failure.]<BR>        }<BR>    else<BR>        [Show appropriate error message.]<BR><BR>    return;<BR>    }</code></pre>
<P>That's it—a client needs to do nothing more than ask the moniker to perform its magic. As we'll see shortly, LinkSource does considerable work through the process, but this encapsulation is exactly what makes monikers such a powerful technology. The moniker is a treasure map, and all a client needs to do is ask the moniker for the treasure.</P></font></body></HTML>
