<HTML><HEAD><TITLE>Implementing a Consumer: DataUser</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Implementing a Consumer: DataUser</H2><P>A consumer is any piece of code that obtains and uses an <I>IDataObject </I>pointer. As we'll see in Chapters 12 and 13, the OLE Clipboard and OLE Drag and Drop technologies are two methods of obtaining this pointer. In this chapter, however, we can demonstrate a number of consumer features through a client for the DDataObj and EDataObj samples. This client is DataUser, found in CHAP10\DATAUSER, where all the code is in DATAUSER.CPP. When you run this sample, you'll see the window shown in Figure 10-3. Here the Data Object menu allows you to select the type of object to use (server and data size) as well as to send either <I>GetData </I>or <I>QueryGetData </I>calls to that object's <I>IDataObject </I>interface.</P>
<P>    <img src="f10dd03p.gif"></P>
<P><B>Figure 10-3.</B></P>
<P><B>The DataUser program showing the Data Object menu.</B></P>
<P>DataUser initially creates three in-process data objects from DDataObj by using <I>CoCreateInstance</I>: one for the small data set (<I>CLSID</I><I>_</I><I>DataSmall</I>), one for the medium data set (<I>CLSID</I><I>_</I><I>DataMedium</I>), and one for the large data set (<I>CLSID</I><I>_</I><I>DataLarge</I>). The Use EXE Object menu item will destroy these three objects and create new ones from the local server, EDataObj, instead. The Use DLL Object menu item will destroy the objects once again and switch back to DDataObj.</P>
<P>One of these three objects is always marked as the current object (stored in <I>CApp::m</I><I>_</I><I>pIDataObject</I>) so that any <I>IDataObject </I>call you select through the Data Object menu will be sent to that object. The small data object is the default. You can change the current object—the data size under consideration—through the Data Size menu item, which has the subitems Small, Medium, and Large. Any change in the server being used will reset the current object to the small one.</P></font></body></HTML>
