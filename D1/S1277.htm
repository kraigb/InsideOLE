<HTML><HEAD><TITLE>The Property Page Site: IPropertyPageSite</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>The Property Page Site: <I>IPropertyPageSite</I></H3><P>As the property frame itself manages some state global to all property pages, the <I>IPropertyPageSite </I>pointer passed to <I>IPropertyPage::SetPageSite </I>provides each page with access to this information:</P>
<P><BR></P>
<pre><code>interface IPropertyPageSite : IUnknown<BR>    {<BR>    HRESULT OnStatusChange(DWORD flags);<BR>    HRESULT GetLocaleID(LCID *pLocaleID);<BR>    HRESULT GetPageContainer(IUnknown **ppUnk);<BR>    HRESULT TranslateAccelerator(LPMSG pMsg);<BR>    };</code></pre>
<P>The first global state in the frame is the locale identifier that the client originally passed to <I>OleCreatePropertyFrame</I>. A property page retrieves this identifier through <I>IPropertyPageSite::GetLocaleID </I>and uses it to determine the language of the text returned through <I>IPropertyPage::GetPageInfo </I>and the localization of the controls in the page itself.</P>
<P>The other important global state is whether or not the Apply Now button is enabled. Initially the button is disabled. To enable it, the page first calls <I>IPropertyPageSite::OnStatusChange</I>, in response to which the frame calls <I>IPropertyPage::IsPageDirty</I>. If the latter function returns S_OK, the frame enables the button, allowing calls to <I>IPropertyPage::Apply</I>. Through this interaction, the user knows when there is a change to make permanent. It is the responsibility of a page to call <I>OnStatusChange </I>when changes occur and to implement its own <I>IsPageDirty</I> member properly. <I>OnStatusChange </I>itself takes either the flag PROPPAGESTATUS_DIRTY to indicate that a change has occurred or the flag PROPPAGESTATUS_VALIDATE to indicate that now is a good time to perform data validation.</P>
<P>Of the other two functions, <I>GetPageContainer </I>currently has no defined functionality. It could be used to retrieve an interface for the property sheet frame as a whole, but as yet the frame has no defined interface, so this function will always fail. <I>TranslateAccelerator</I>,<I> </I>on the other hand, works in conjunction with the function of the same name in <I>IPropertyPage. </I>The protocol here is that the frame first notifies the current page of a keystroke by calling <I>IPropertyPageFrame::TranslateAccelerator. </I>If the page does not want to override a key that the frame usually processes, it should call the page site's <I>TranslateAccelerator </I>for that key and then process it normally. In short, the site gives the page the ability to preprocess keys before eating them.</P></font></body></HTML>
